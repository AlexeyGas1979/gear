title: token-vendor

programs:
  - id: 1
    path: examples/target/wasm32-unknown-unknown/release/token_vendor.wasm
    init_message:
      kind: custom
      value:
        members:
          [
            "0600000000000000000000000000000000000000000000000000000000000000",
            "0700000000000000000000000000000000000000000000000000000000000000",
          ]
        reward: 10
        code: "TEST"
        admins:
          ["0100000000000000000000000000000000000000000000000000000000000000"]

  - id: 2
    path: examples/target/wasm32-unknown-unknown/release/contract_example_reply.wasm
    init_message:
      kind: utf-8
      # member id ProgramId(6)
      value: "0600000000000000000000000000000000000000000000000000000000000000"
  - id: 3
    path: examples/target/wasm32-unknown-unknown/release/contract_example_reply.wasm
    init_message:
      kind: utf-8
      # member id ProgramId(7)
      value: "0700000000000000000000000000000000000000000000000000000000000000"
  - id: 6 # emulate member ProgramId(6)
    path: examples/target/wasm32-unknown-unknown/release/demo_minimal.wasm
    init_message:
      kind: utf-8
      value: ""
  - id: 7 # emulate member ProgramId(7)
    path: examples/target/wasm32-unknown-unknown/release/demo_minimal.wasm
    init_message:
      kind: utf-8
      value: ""

fixtures:
  - title: token-vendor
    messages:
      - payload:
          kind: custom
          value:
            programId: "0200000000000000000000000000000000000000000000000000000000000000"
        destination: 1
        source: 6 # member id ProgramId(6)
      - payload:
          kind: custom
          value:
            programId: "0300000000000000000000000000000000000000000000000000000000000000"
        destination: 1
        source: 7 # member id ProgramId(7)
      - payload:
          kind: custom
          value:
            updateConfig:
              {
                "members":
                  [
                    "0600000000000000000000000000000000000000000000000000000000000000",
                    "0700000000000000000000000000000000000000000000000000000000000000",
                  ],
                "reward": 1,
                "code": "UPDATE",
                "admins":
                  [
                    "0100000000000000000000000000000000000000000000000000000000000000",
                  ],
              }
        destination: 1
        source: 1
    expected:
      - step: 10
        messages:
          - destination: 6
            payload:
              kind: utf-8
              value: "success"
            value: 1
          - destination: 7
            payload:
              kind: utf-8
              value: "success"
            value: 1
